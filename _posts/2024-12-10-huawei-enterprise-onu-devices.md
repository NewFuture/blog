---
layout: post
title: 总结一下折腾过的华为企业光猫(ONU)
subtitle: 光猫基本信息和拆机图
private: true
# feature-img: 
---

## 用过的家用光猫
回顾这两年使用的三大运营商宽带和他们提供的光猫，主流设备基本都体验过。

* 移动200M: 华为 HS8145V (带WiFi5)，测速较稳定，WiFi体验较差，报故障无效。
* 移动1000M: 中移定制老猫，型号记不清了，带2.4G WiFi，古董猫，体验很差，甚至电视都卡。
* 电信100M/1000M: 烽火 HG6540A (不带WiFi)，开机内存超过50%，晚上出现过几次死机，装维反馈显示正常。
* 联通500M: 中兴 ZXHN 7610Uv3 (带WiFi6)，WiFi出现过两次能连上，但网络极卡，不知原因。
* 联通2000M: 华为 V175 (FTTR主猫) + K155 (子猫)，体验不错，温度率高，漫游效果一般。

最初促使我更换光猫并研究光猫的原因是网络不稳定（曾一度错怪路由器），但报宽带故障时，后台显示一切正常，上门检测也正常。基本是个人的主观感受，可能不一定是光猫的问题。
然后询问业内人士推荐，华为的企业光猫最好，于是开始研究华为的企业光猫。

## 关于华为企业光猫系列

企业光猫，也叫政企ONU（政企光网络单元），是华为针对企业用户推出的光纤接入设备，主要用于接入光纤到楼宇、园区、企业等场景。与普通的家用光猫相比，企业光猫在性能、功能和管理上都有更高的要求。

主要分为两大系列，B系列和P系列，B系列主要通过运营商渠道销售，P系列则面向中小企业和零售市场。
B系列是运营商渠道专供产品，走运营商合同，终端客户售后运营商负责，固件更新通过运营商渠道下发，软件定制主要有三大运营商定制版和公版（Common）。
P系列是华为政企投标或者零售产品，主要针对中小企业，售后可以直接在官网序列号注册，固件更新在产品页提供，版本有公版（Common）和China定制版（界面和公版一样无插件但限制更多）。
因为P系列可以直接享受官网服务，因此P系列通常会比B系列价格略高。

P系列型号数字含义：
* 首位数字表示上行
  * 6__: GPON/EPON 上行
  * 8__： XSGPON 万兆对称上行
* 第二位数字表示POE信息
  * \_0_: 不支持POE供电
  * \_1_: 支持POE供电
  * \_2_: 支持POE++供电
* 第三位数字表示网口数量
  * __2: 4网口
  * __3: 8网口
  * __5: 24网口

## 设备总结

| 型号        | CPU         | 内存 | 接口      | WiFi   | 其他功能     | 功耗范围     |
| ----------- | ----------- | ---- | --------- | ------ | ------------ | ------------ |
| **B610-4E** | 双核 2GHz   | 512M | 4 GE      | 无     | 无reset孔    | 3.5W~5W      |
| B610-S1     | 双核 1.6GHz | 512M | 4 GE      | 无     | 无电源键     | --           |
| **P603E**   | 双核 2GHz   | 512M | 8 GE      | 无     | 正常都有     | 3.24W~5.64W  |
| P603E-E     | 双核 1.6GHz | 512M | 8 GE      | 无     | 上行SFP口    | 5W~8W        |
| P813E-E     | 双核 2GHz   | 1G   | 8GE(POE+) | 无     | 上行万兆SFP  | 10W~14W/138W |
| B866-s1     | 双核 1.6GHz | 1G   | 4GE+USB   | AX3000 | 下行FTTR PON | --           |

注: 这里功耗使用的是官方提供的静态功耗和最大功耗数据（不包含电源）。

## 用过的企业光猫和拆机图

企业光猫都是铁盒的，采用抽屉式设计，拆机很方便，最初拆机其实是为了加散热片。

### B610-4E

最流行的企业光猫，差不多也是最便宜的企业光猫。大部分是公版，少量是电信定制版和移动定制版。尺寸小，手机的长度。

一代弱电箱神器。（还有一个政企版P602E，硬件和系统一样，定制信息不一样，未体验过）。

![B610-4E](/assets/img/huawei-enterprise-onu-devices/B610-4E.jpg)

* 上行口: 1个PON口 (GPON/EPON双线路)
* LAN口: 4个千兆口
* 按键: 一个开关 (无重置孔)
* 电源: 12v1A 5521接口

没有重置孔有时候会给配置带来麻烦，特别是在需要恢复出厂设置时。

![B610-4E拆机图](/assets/img/huawei-enterprise-onu-devices/B610-4E_inner.jpg)

内部，没有任何散热片，所以和很多人一样拆机加上散热片（心理安慰）。
芯片是双核2GHz的CPU，内存512M，闪存128M。

实测功耗很低，空载只有3点几瓦，高负载时温度也很低（35℃的室温，弱电箱里高负载下芯片温度不到50℃）。

### B610-S1-4E

在B610上加了一个s1尾巴，是B610的**缩小版**，体积更小，铁盒质量也缩水了，芯片也缩水了。主要是移动定制版，少量公版。非常小巧，可以塞到小空间里。

![B610-s1](/assets/img/huawei-enterprise-onu-devices/B610-s1.jpg)

* 上行口: 1个PON口 (GPON/EPON双线路)
* LAN口: 4个千兆口
* 按键: 一个重置口，无电源开关
* 电源: 12v1A 5521接口

![B610-S1-4E拆机图](/assets/img/huawei-enterprise-onu-devices/B610-s1_inner.jpg)

内部主板更紧凑，看不到CPU是因为CPU在背面直接贴着底板散热（散热设计不错）。
芯片是双核1.6GHz的CPU（据说有少量2GHz版，没见过），内存512M，闪存256M。

使用时芯片和外壳温度略高于B610-4E，但区别不明显。

### P603E

P603E是8口光猫。这个型号在市面流通的比较少，零售的很少见到，主要是政企投标产品，而且见到的基本都是China定制版。

这个硬件形态适合网口超过4个的场景，该有功能都有，也没有多余的接口或者按钮。

![P603E](/assets/img/huawei-enterprise-onu-devices/P603E.jpg)

* 上行口: 1个PON口 (GPON/EPON双线路)
* LAN口: 8个千兆口
* 按键: 一个电源开关 + 一个重置口
* 电源: 12v1A 4017接口

![P603E拆机图](/assets/img/huawei-enterprise-onu-devices/P603E_inner.jpg)

主板上多了两块屏蔽罩，CPU外面导热片直接导热到顶盖散热。这个更符合一个工业级网络设备的硬件标准。

芯片和B610-4E一样，都是双核2GHz的CPU，内存512M，闪存128M。

实测功耗也很低，空载也只有3点几瓦。

### P603E-E

P603E-E在P603E的基础上加了一个上行SFP口，体积大小没变。
这个系列的外观设计做了升级，颜值更高，适合放在桌面。
正面和网口都换成黑色了，网口信号灯都换到网口旁边，并且显示更多状态。
缺点是CPU缩水了，功耗和产热更高。

![P603E-E](/assets/img/huawei-enterprise-onu-devices/B610+P603E-E.jpg)

* 上行口: 1个PON口 (GPON/EPON双线路) + 1个SFP口
* LAN口: 8个千兆口
* 按键: 一个重置口（无电源开关）
* 电源: 12v1A 4017接口

![P603E-E拆机图](/assets/img/huawei-enterprise-onu-devices/P603E-E_inner.jpg)

主板上CPU和内存都有屏蔽罩，并且导热到顶部外壳散热。

CPU是双核1.6GHz的CPU，内存512M，闪存256M。
实测功耗接近6瓦，和P603E比就有点高。

### P813E-E

P813E-E，外观模型和P603E-E一样，但支持XGS-PON（万兆对称）/XGPON/10GEPON，同时带一个上行SFP口，带8个GE口支持POE/POE+。可以外接监控和无线AP，适合小园区和小别墅。
这款内存扩容到1G，前几年基本上算是顶配了。

![P813E-E](/assets/img/huawei-enterprise-onu-devices/P813E-E.jpg)

* 上行口: 万兆PON口 (XGS-PON/XGPON/10GEPON) + 万兆SFP口
* LAN口: 8个千兆口（支持POE/POE+）
* 按键: 一个重置口（无电源开关）
* 电源: 56v2.68A（150W）5021接口

![P813E-E拆机图](/assets/img/huawei-enterprise-onu-devices/P813E-E_inner.jpg)

主板上CPU和内存和光模块都有屏蔽罩，并且芯片和光模块以及SFP口导热到顶部外壳散热。

CPU是双核2GHz的CPU，内存1024M（1G），闪存256M。
由于使用的是150W大功率电源，实测功耗比较高在10W左右，不接POE的话功耗不大。

### B866-s1

B866-s1是第一款带下行光口的FTTR企业光猫，体积巨大，比8口光猫的盒子也要大一圈。这个型号1G内存，带机量挺高。自带AX3000的WiFi，信号和稳定性还行，但体积大和功耗大，不是很推荐。

![B866-s1](/assets/img/huawei-enterprise-onu-devices/B866-s1.jpg)

* 上行口: 1个PON口 (XGPON/10GEPON)
* 下行口: 1个PON口 (GPON)
* LAN口: 4个千兆口
* 按键: 电源开关+重置口
* 电源: 12v2A 5521接口
* 接口: 1 USB口 + 1 语音口

![B866-s1拆机图](/assets/img/huawei-enterprise-onu-devices/B866-s1_inner.jpg)

这款相较于前面几款P系列的光猫，散热设计比较简单，直接在CPU和内存和FPGA上散热鳍片，没有使用导热到外壳的方式。整体质量很重，接近2Kg，外壳虽然和P603E的样式看起来一样，但质感感觉有点薄（也可能是太大的原因），感觉不如B610-s1的外壳质感。

CPU是双核1.6GHz的CPU，内存1G，闪存256M。下行口是用FPGA控制的，无法关闭。
功耗在9W左右，功耗比较高。

## 总结

### 关于芯片

1. 可以看到这些年华为企业光猫的芯片基本没有什么发展甚至退步了。频率降低（越高性能越好）了功耗反而升高了（功耗越低越好）。最经典的就是B610-4E和P603E，都是双核2GHz的CPU，功耗也很低，温度也很低，这些都是2020/2021年左右出来的设备。后续的B610-s1，P603E-E虽然频率降低了，但功耗和温度反而升高了。

2. 这些企业光猫在正常不加过滤的情况下，即使用路由模式，几乎不会占用CPU和内存。NAT和转发都硬件加速，CPU几乎不占用。CPU和内存占用更多的时候是被一些插件占用，在家用光猫最明显，部分企业的定制版也有一些插件。
CPU的性能其实不必刻意追求，反而是功耗会反映出产热量，更影响设备的寿命和稳定性。

![cpu usage](/assets/img/huawei-enterprise-onu-devices/iperf-cpu.png)

3. 通过网络上其它拆机和测评，明显感觉10GPON的猫和2.5G网口的猫，功耗较高，发热量也高。虽然散热改进不少，也在正常温度范围内工作，但是塞进封闭弱电箱对于功耗会很在意。

### 关于FTTR

现在运营商天天推FTTR，FTTR某些时候的确是一个很好的方案，但FTTR的确是一个不成熟的方案。站在2024年看，FTTR依然不是一个比网线更好的方案。
FTTR都是利用下行GPON口连接和管理子设备，PON口的功率不比交换机芯片低，但运行模式类似于落后的集线器（不懂集线器和交换机的区别可以自行搜索一下）。FTTR内网所有光纤依赖于PON的带宽，外网流量也要走PON的带宽，内外网都卡在这个2.5G下行带宽这里，这远不如一个普通的4口千兆交换机背宽。对于使用内网小主机/NAS或者内网监控视频的场景，网线还是未来几年最好的选择。
按照现在路线发展等低功率内网万兆对称PON普及，FTTR才会是一个更快的方案。这也是我基本不怎么折腾FTTR设备的原因。实际体验测速FTTR的漫游效果和mesh其实差不多，还比不上企业AP方案。

目前只有在未走网线，而且FTTR可以走透明光纤的时候，FTTR才是一个更好的选择。

### 关于宽带瓶颈

现在宽带最大的瓶颈是延时和抖动，其次是上行带宽。在北京上海这种地方可能感觉不明显。但是一旦数据中心在外地或者跨区域传输，延时和抖动就会很明显，玩游戏和视频电话影响比较大。
上行的问题是，上下行严重不对称。人多或者远程的时候就容易卡，比如电信的千兆带宽下行1000Mbps，上行只有50Mbps（还是2024年工信部提高之后的水平）。

现在运营商都在宣传2000M带宽甚至万兆带宽，但实际上，现在下行带宽基本上不会是家庭带宽的瓶颈(除非是天天跑BT下载的玩家)。
之前用联通2000M带宽，5个人用，包括两台电脑，看过2周宽带宽的统计报告，去掉专门跑测速的时间段，峰值流量基本上没有超过500Mbps，绝大部分时间都在100Mps以下。对于绝大多数人200M~500M的带宽就足够了，应为大部分应用(微信抖音视频APP网盘等)对下载其实都有限速。

### 目前最佳的企业猫

华近年出的万兆猫感觉都不完美，功耗和性能都低于预期。
期待的**低功耗**全2.5G口的成熟10GPON猫也一直没有，目前看这两年估计无望了。

* 4网口 B610-4E 依然功耗最低，性能好。
* 8网口 P603E 可能颜值稍微差一点，但是其它做工，芯片，散热，功耗和按钮都无可挑剔。


